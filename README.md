Core logic for Megroplan extensions